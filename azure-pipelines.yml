jobs:
- job: VisualStudio2019
  timeoutInMinutes: 120
  pool:
    vmImage: windows-2019
  strategy:
    matrix:
      Debug64:
        BuildPlatform: x64
        BuildConfiguration: Debug
      Release64:
        BuildPlatform: x64
        BuildConfiguration: Release
      Debug32:
        BuildPlatform: x86
        BuildConfiguration: Debug
      Release32:
        BuildPlatform: x86
        BuildConfiguration: Release
  variables:
    DOTNET_SDK_VERSION: '3.1.406'
  steps:
    - task: UseDotNet@2
      displayName: 'Use .NET Core SDK $(DOTNET_SDK_VERSION)'
      inputs:
        version: '$(DOTNET_SDK_VERSION)'

    - task: NuGetToolInstaller@1
      displayName: "Install NuGet v5.4.0"
      inputs:
        versionSpec: 5.4.0

    #- powershell: $(Build.SourcesDirectory)\Build\OpenDDSharp.Build.CppCli.ps1 --BuildConfiguration=$(BuildConfiguration) --BuildPlatform=$(BuildPlatform) --VisualStudioVersion=VS2019
    #  displayName: 'Build & Test with Cake'
    #  workingDirectory: $(Build.SourcesDirectory)\Build

    - task: DotNetCoreCLI@2
      inputs:
        command: run
        projects: $(Build.SourcesDirectory)\Build\OpenDDSharp.Build.CppCli\OpenDDSharp.Build.CppCli.csproj
        arguments: '--BuildConfiguration=$(BuildConfiguration) --BuildPlatform=$(BuildPlatform) --VisualStudioVersion=VS2019'
        workingDirectory: $(Build.SourcesDirectory)\Build
      displayName: 'Build & Test with Cake'

#- job: VisualStudio2017
#  timeoutInMinutes: 120
#  pool:
#    vmImage: vs2017-win2016
#  strategy:
#    matrix:
#      Debug64:
#        BuildPlatform: x64
#        BuildConfiguration: Debug
#      Release64:
#        BuildPlatform: x64
#        BuildConfiguration: Release
#      Debug32:
#        BuildPlatform: x86
#        BuildConfiguration: Debug
#      Release32:
#        BuildPlatform: x86
#        BuildConfiguration: Release
#  variables:
#    DOTNET_SDK_VERSION: '3.1.406'
#  steps:
#    - task: UseDotNet@2
#      displayName: 'Use .NET Core SDK $(DOTNET_SDK_VERSION)'
#      inputs:
#        version: '$(DOTNET_SDK_VERSION)'
#
#    - task: NuGetToolInstaller@1
#      displayName: "Install NuGet v5.4.0"
#      inputs:
#        versionSpec: 5.4.0
#
#    - powershell: $(Build.SourcesDirectory)\Build\OpenDDSharp.Build.CppCli.ps1 --BuildConfiguration=$(BuildConfiguration) --BuildPlatform=$(BuildPlatform) --VisualStudioVersion=VS2017
#      displayName: 'Build & Test with Cake'
#      workingDirectory: $(Build.SourcesDirectory)\Build